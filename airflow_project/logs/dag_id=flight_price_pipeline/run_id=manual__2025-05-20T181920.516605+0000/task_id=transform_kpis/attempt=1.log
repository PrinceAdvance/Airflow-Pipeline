[2025-05-20T18:20:50.094+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: flight_price_pipeline.transform_kpis manual__2025-05-20T18:19:20.516605+00:00 [queued]>
[2025-05-20T18:20:50.124+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: flight_price_pipeline.transform_kpis manual__2025-05-20T18:19:20.516605+00:00 [queued]>
[2025-05-20T18:20:50.126+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 1
[2025-05-20T18:20:50.175+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): transform_kpis> on 2025-05-20 18:19:20.516605+00:00
[2025-05-20T18:20:50.189+0000] {standard_task_runner.py:57} INFO - Started process 1015 to run task
[2025-05-20T18:20:50.199+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'flight_price_pipeline', 'transform_kpis', 'manual__2025-05-20T18:19:20.516605+00:00', '--job-id', '24', '--raw', '--subdir', 'DAGS_FOLDER/dag_flight_pipeline.py', '--cfg-path', '/tmp/tmp7or3qp1z']
[2025-05-20T18:20:50.208+0000] {standard_task_runner.py:85} INFO - Job 24: Subtask transform_kpis
[2025-05-20T18:20:50.385+0000] {task_command.py:416} INFO - Running <TaskInstance: flight_price_pipeline.transform_kpis manual__2025-05-20T18:19:20.516605+00:00 [running]> on host afdaae69c771
[2025-05-20T18:20:50.691+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='flight_price_pipeline' AIRFLOW_CTX_TASK_ID='transform_kpis' AIRFLOW_CTX_EXECUTION_DATE='2025-05-20T18:19:20.516605+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-20T18:19:20.516605+00:00'
[2025-05-20T18:20:50.697+0000] {transform.py:6} INFO - Starting KPI transformation task
[2025-05-20T18:20:50.872+0000] {logging_mixin.py:151} WARNING - /opt/***/dags/tasks/transform.py:16 UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
[2025-05-20T18:20:51.380+0000] {transform.py:18} INFO - Loaded 114000 rows for KPI computation
[2025-05-20T18:20:51.526+0000] {transform.py:27} INFO - üìä Average Total Fare per Airline:
                  Airline   Total Fare
               Air Arabia 69924.011840
                Air Astra 68497.407118
                Air India 72474.182215
                  AirAsia 74534.389529
Biman Bangladesh Airlines 70192.970951
          British Airways 70555.535482
           Cathay Pacific 73325.089224
                 Emirates 70106.150834
           Etihad Airways 71785.236683
                 FlyDubai 68987.686965
                 Gulf Air 71458.163156
                   IndiGo 72504.442416
           Kuwait Airways 71988.274562
                Lufthansa 69293.164983
       Malaysian Airlines 72775.178608
                  NovoAir 68350.857257
            Qatar Airways 69865.535496
                   Saudia 69270.675222
       Singapore Airlines 68323.925511
       SriLankan Airlines 71265.261004
             Thai Airways 72845.787513
         Turkish Airlines 75547.266658
       US-Bangla Airlines 72088.291544
                  Vistara 68108.245072
[2025-05-20T18:20:51.535+0000] {transform.py:28} INFO - ‚úàÔ∏è Most Frequent Routes:
Source Destination  Flight Count
   RJH         SIN           834
   DAC         DXB           826
   BZL         YYZ           820
   CXB         DEL           816
   CGP         BKK           816
[2025-05-20T18:20:51.539+0000] {transform.py:29} INFO - üèÜ Top 5 Destinations:
Destination  Flight Count
        JED          6142
        DEL          6138
        JFK          6132
        SIN          6126
        BKK          6072
[2025-05-20T18:20:51.540+0000] {transform.py:31} INFO - ‚úÖ KPI computation completed successfully
[2025-05-20T18:20:51.559+0000] {python.py:194} INFO - Done. Returned value was: None
[2025-05-20T18:20:51.582+0000] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=flight_price_pipeline, task_id=transform_kpis, execution_date=20250520T181920, start_date=20250520T182050, end_date=20250520T182051
[2025-05-20T18:20:51.662+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 0
[2025-05-20T18:20:51.719+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
